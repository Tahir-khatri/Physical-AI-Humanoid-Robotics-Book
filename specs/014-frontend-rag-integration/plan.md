# Implementation Plan: Frontend RAG Integration

**Branch**: `014-frontend-rag-integration` | **Date**: 2026-01-02 | **Spec**: [spec.md](./spec.md)
**Input**: Feature specification from `specs/014-frontend-rag-integration/spec.md`

## Summary

This plan details the technical approach for creating a simple frontend and integrating it with the existing FastAPI RAG backend. The goal is to establish an end-to-end flow where a user can send a query from a web UI and see the agent's response. The implementation will use static HTML, CSS, and JavaScript for simplicity.

## Technical Context

**Language/Version**: HTML5, CSS3, JavaScript (ES6+), Python 3.11 (for backend)
**Primary Dependencies**: `fastapi` (backend), `fetch` API (frontend)
**Storage**: N/A (This feature is for UI and communication)
**Testing**: Manual end-to-end testing by running both servers locally.
**Target Platform**: Modern web browsers.
**Project Type**: Web Application (Frontend + Backend modification)
**Performance Goals**: UI should be responsive for user input; chat responses should appear without significant delay after the backend provides them.
**Constraints**: Local execution only. No new backend logic beyond enabling communication.
**Scale/Scope**: A simple, single-page interface for local testing and demonstration.

## Constitution Check

*GATE: Must pass before Phase 0 research. Re-check after Phase 1 design.*

- [x] **Spec-Driven**: All work is traceable to `specs/014-frontend-rag-integration/spec.md`.
- [x] **Grounding**: This feature enables interaction with the RAG agent, which is grounded in the book content.
- [x] **Modernity**: The backend stack is modern; the frontend is intentionally simple for this integration task.
- [x] **Constraints**: The solution is for local execution and does not add any new hosted components.

## Project Structure

### Documentation (this feature)

```text
specs/014-frontend-rag-integration/
├── plan.md              # This file
├── research.md          # Research on CORS and frontend fetch
├── data-model.md        # Not applicable for this feature
├── quickstart.md        # Setup and execution guide for end-to-end run
├── contracts/           # Not applicable (consumes existing API)
└── tasks.md             # To be generated by /sp.tasks
```

### Source Code (repository root)

This feature adds a new `frontend` directory and modifies the existing `backend`.

```text
backend/
└── agent/
    └── main.py          # Modified to include CORS middleware

frontend/
├── index.html           # The main UI page for the chatbot
├── app.js               # Frontend JavaScript logic for API calls
└── style.css            # Basic styling for the chat interface
```

**Structure Decision**: A new top-level `frontend/` directory is created to hold the simple static UI, cleanly separating it from all backend code. The existing backend is modified in-place to allow communication.

## Phase 0: Research

Technical decisions regarding FastAPI CORS configuration and the use of the `fetch` API are documented in `research.md`.

- **Reference**: [research.md](./research.md)

## Phase 1: Design

### Data Model

Not applicable for this feature, as it does not introduce new database schemas.

### API Contracts

Not applicable for this feature, as it consumes the API defined in `013-rag-agent-backend`.

### High-Level Architecture

1.  **Backend Modification (`backend/agent/main.py`)**:
    -   The FastAPI app instance will be configured with `CORSMiddleware`.
    -   The `allow_origins` list will be set to permit requests from the local development server's origin (e.g., "http://127.0.0.1:5500").

2.  **Frontend UI (`frontend/index.html`)**:
    -   A basic HTML structure containing:
        -   A container to display the chat history.
        -   A form with a text input for the user's question.
        -   A "Send" button.

3.  **Frontend Logic (`frontend/app.js`)**:
    -   An event listener will be attached to the form's submit event.
    -   On submit, it will prevent the default form action, get the user's query from the input, and display the user's message in the chat history.
    -   It will use the `fetch` API to send a `POST` request to the backend's `/chat` endpoint. The `session_id` will be stored in a JavaScript variable and included in subsequent requests.
    -   The JSON response from the backend will be parsed.
    -   The `answer` from the response will be used to create and display the assistant's message in the chat history.
    -   A `catch` block will handle network errors and display a user-friendly error message in the chat window.

### Quickstart Guide

A guide for running both the backend and frontend servers to test the end-to-end application is available in `quickstart.md`.

- **Reference**: [quickstart.md](./quickstart.md)

## Complexity Tracking

No violations of the project constitution were identified. Complexity is low, focused primarily on frontend-backend communication.
# Data Model: RAG Content Pipeline

**Date**: 2025-12-30
**Feature**: `011-rag-content-pipeline`

This document defines the data structures used in the content ingestion pipeline, primarily focusing on the data stored in the Qdrant vector database.

## Entity: `VectorRecord`

This is the core entity representing a single piece of embedded content stored in the vector database. Each record consists of the vector embedding itself and a payload containing the text and its metadata.

### Schema

The `VectorRecord` corresponds to a `PointStruct` in the `qdrant-client` library.

- **`id`**: `UUID` or `integer`
  - A unique identifier for the point in the collection. The pipeline will generate sequential integer IDs for simplicity during a single run.
- **`vector`**: `array[float]` (Dimension: 1024)
  - The dense vector embedding generated by the Cohere `embed-english-v3.0` model.
- **`payload`**: `object`
  - A JSON object containing the source data and metadata for the vector. This data is indexed and can be used for filtering during search.

### Payload Schema

The `payload` object contains the following fields:

- **`text`**: `string`
  - **Description**: The actual text content of the chunk that was embedded.
  - **Example**: `"Docusaurus uses the @docusaurus/plugin-sitemap to generate this file."`
- **`url`**: `string`
  - **Description**: The full URL of the source page from which the text chunk was extracted.
  - **Example**: `"https://docusaurus.io/docs/api/plugins/sitemap"`
- **`section_title`**: `string`
  - **Description**: The content of the nearest preceding heading (`h1`, `h2`, etc.) to the text chunk. This provides contextual information about the chunk's topic. If no heading is found, this can be the page title or null.
  - **Example**: `"Installation"`
- **`chunk_index`**: `integer`
  - **Description**: The 0-based index of this chunk within the source page. This helps in reconstructing the original document order if needed.
  - **Example**: `3`
- **`processed_at`**: `string` (ISO 8601 format)
  - **Description**: The UTC timestamp indicating when the chunk was processed and embedded.
  - **Example**: `"2025-12-30T10:00:00Z"`

### Example Qdrant Point

Here is an example of a `PointStruct` that would be upserted into Qdrant:

```python
from qdrant_client.http import models

point = models.PointStruct(
    id=101,
    vector=[0.12, 0.45, ..., -0.08],  # Example 1024-dimensional vector
    payload={
        "text": "The pipeline will be a Python script utilizing the following core libraries...",
        "url": "https://physical-ai-humanoid-robotics.com/docs/module-1/chapter-2",
        "section_title": "Technology Stack and Tooling",
        "chunk_index": 5,
        "processed_at": "2025-12-30T10:00:05Z"
    }
)
```
